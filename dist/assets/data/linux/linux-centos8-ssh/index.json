{"hash":"f1152a80235e9bc1c2520b2e0d208aa7cd399663","data":{"markdownPage":{"id":"109b66ea2c74023a8155241d937700a7","title":"","description":"","path":"/linux/linux-centos8-ssh/","timeToRead":1,"content":"<p>Linux centos8 VPS基本配置之SSH</p>\n<p>最近在使用阿里云的时候，需要安装一些nodejs模块，但是总是安装失败，我已经使用了淘宝镜像cnpm加速，查看了具体原因是有github的依赖。 阿里云访问github出奇的慢，查了很多资料，也在论坛里向阿里反应过这个问题，但是貌似无解。所以没有办法，我只能把东京VPS重新启动起来，每月5美元，然后从阿里云SSH到VPS，速度老快，还可以VVPPNN，查英文资料，想干啥就干啥，杠杠的！</p>\n<p>使用如下链接注册的新用户，可以获得100美元，估计可以免费使用好多个月，有需要的可以试试。</p>\n<p><a href=\"https://www.vultr.com/?ref=6859185\"><img src=\"https://www.vultr.com/media/banners/banner_468x60.png\" width=\"468\" height=\"60\"></a></p>\n<p>由于是从centos6升级到centos8，所以有些命令改动，在VPS网站申请好实例后，从web控制台登录进行修改密码和SSH的配置。下面记录基本的配置过程：</p>\n<h3 id=\"修改密码\"><a href=\"#%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>修改密码</h3>\n<p>使用root账号在web控制台登录，然后使用命令passwd修改新密码。</p>\n<h3 id=\"检查或者修改ssh的端口\"><a href=\"#%E6%A3%80%E6%9F%A5%E6%88%96%E8%80%85%E4%BF%AE%E6%94%B9ssh%E7%9A%84%E7%AB%AF%E5%8F%A3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>检查或者修改SSH的端口</h3>\n<pre class=\"language-bash\"><code class=\"language-bash\">修改SSH配置文件\n<span class=\"token function\">vim</span> /etc/ssh/sshd_config\nPort <span class=\"token number\">22</span></code></pre>\n<h3 id=\"配置selinux\"><a href=\"#%E9%85%8D%E7%BD%AEselinux\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>配置SELinux</h3>\n<pre class=\"language-text\"><code class=\"language-text\">配置SELinux允许SSH端口，或者你也可以直接关闭SELinux.\n先查看SELinux开放给ssh使用的端口\nsemanage port -l|grep ssh\n我的系统打印如下：\nssh_port_t tcp 22\n如果没有打开实行如下命令\nsemanage port -a -t ssh_port_t -p tcp 22\n完成后，再次查看\nsemanage port -l|grep ssh\nssh_port_t tcp 22</code></pre>\n<h3 id=\"配置防火墙\"><a href=\"#%E9%85%8D%E7%BD%AE%E9%98%B2%E7%81%AB%E5%A2%99\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>配置防火墙</h3>\n<pre class=\"language-text\"><code class=\"language-text\">配置防火墙允许SSH端口：\n如果你关闭了防火墙，可以忽略此步。\n先查看防火墙是否开启了10086端口：\nfirewall-cmd --permanent --query-port=22/tcp\n打印结果如下：\nno\n表示没有开放22端口，那么添加下该端口：\nfirewall-cmd --permanent --add-port=22/tcp\n打印结果如下：\nsuccess\n重新加载防火墙策略：\nfirewall-cmd --reload\n执行成功后，查看22端口是否被开启：\nfirewall-cmd --permanent --query-port=10086/tcp\n打印结果如下：\nyes</code></pre>\n<h3 id=\"重启防火墙\"><a href=\"#%E9%87%8D%E5%90%AF%E9%98%B2%E7%81%AB%E5%A2%99\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>重启防火墙</h3>\n<pre class=\"language-text\"><code class=\"language-text\">重启SSH服务和防火墙，最好也重启下服务器\nsystemctl restart sshd\nsystemctl restart firewalld.service\nshutdown -r now</code></pre>\n<h3 id=\"从阿里云到vps\"><a href=\"#%E4%BB%8E%E9%98%BF%E9%87%8C%E4%BA%91%E5%88%B0vps\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>从阿里云到VPS</h3>\n<p>两台Linux的SSH,在阿里云上执行如下脚本，然后实现阿里云到VPS的SSH：<br>\nsh nopasswd.sh USER REMOTE_HOST<br>\n本机上已有 id_dsa.pub ,若无。 使用命令 ssh-keygen -t dsa 获得。<br>\n远程机上登录用户家目录下，已经有 .ssh 文件夹，若无创建之。  </p>\n<pre class=\"language-text\"><code class=\"language-text\">nopasswd.sh\n#!/bin/sh\nscp ~/.ssh/id_rsa.pub  $1@$2:~/\nssh $1@$2 &quot; touch ~/.ssh/authorized_keys ; cat ~/id_rsa.pub  &gt;&gt; ~/.ssh/authorized_keys; chmod 644 ~/.ssh/authorized_keys; exit&quot;</code></pre>\n<h3 id=\"使用putty或者windows的linux子系统ssh\"><a href=\"#%E4%BD%BF%E7%94%A8putty%E6%88%96%E8%80%85windows%E7%9A%84linux%E5%AD%90%E7%B3%BB%E7%BB%9Fssh\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>使用putty或者Windows的Linux子系统SSH</h3>\n<p>在Linux 主机下产生的私钥zd文件putty是不认识的，putty只认识自己的ppk格式，要在这两种格式之间转换，需要PuTTYgen这个程版序。 puttygen是putty的配套程序，putty的安装包和winscp的安装包都权包含了这个程序</p>\n","sidebar":"","next":"","prev":"","headings":[{"depth":3,"value":"修改密码","anchor":"#修改密码"},{"depth":3,"value":"检查或者修改SSH的端口","anchor":"#检查或者修改ssh的端口"},{"depth":3,"value":"配置SELinux","anchor":"#配置selinux"},{"depth":3,"value":"配置防火墙","anchor":"#配置防火墙"},{"depth":3,"value":"重启防火墙","anchor":"#重启防火墙"},{"depth":3,"value":"从阿里云到VPS","anchor":"#从阿里云到vps"},{"depth":3,"value":"使用putty或者Windows的Linux子系统SSH","anchor":"#使用putty或者windows的linux子系统ssh"}]},"allMarkdownPage":{"edges":[{"node":{"path":"/devops/dev-ops-jobs/","title":"为什么需要DevOps"}},{"node":{"path":"/devops/dev-ops-skill/","title":""}},{"node":{"path":"/devops/dev-ops-summary/","title":"什么是 cicd，devops"}},{"node":{"path":"/linux/linux-centos8-ssh/","title":""}},{"node":{"path":"/devops/","title":"什么是 cicd，devops"}},{"node":{"path":"/devops/all/","title":"DevOps"}},{"node":{"path":"/devops/dev-ops-tools/","title":""}}]}},"context":{}}